default_platform :ios

platform :ios do

  desc "Bump version and build number"
  lane :bump_version_number_and_build_number do
    # VERSION = last_git_tag(pattern: "*.*.*.*")
    # increment_version_number_in_xcodeproj(
    #   version_number: VERSION
    # )
    increment_build_number_in_xcodeproj(
        target: "Zescape",
        build_number: Time.now.strftime('%Y%m%d%H%M'),
        xcodeproj: "./Zescape/Zescape.xcodeproj"
    )
  end

  lane :add_badge_alpha do |options|
    add_badge(alpha: true)
  end

  desc "Build"
  lane :build do |options|
  # Build & export ipa
    match(type: "adhoc", readonly: true)
    gym(
      scheme: "Zescape",
      silent: options[:silent] || true,
      project: "./Zescape/Zescape.xcodeproj",
      configuration: "Release",
      output_name: "Zescape"
    )
  end
end
